using System;
using System.ComponentModel.DataAnnotations;
using System.Text.RegularExpressions;

public class VehicleRegistrationAttribute : ValidationAttribute
{
    private static readonly Regex _regex = new Regex(
        @"^([A-Z]{2}\d{1,2}[A-Z]{1,2}\d{1,4}|\d{2}BH\d{4}[A-Z]{1,2})$",
        RegexOptions.Compiled | RegexOptions.IgnoreCase);

    public VehicleRegistrationAttribute()
    {
        ErrorMessage = "Invalid vehicle registration number format.";
    }

    protected override ValidationResult IsValid(object value, ValidationContext validationContext)
    {
        if (value == null)
            return ValidationResult.Success; // Handle [Required] separately

        var strValue = value.ToString().Trim().ToUpper();

        if (_regex.IsMatch(strValue))
            return ValidationResult.Success;

        return new ValidationResult(ErrorMessage);
    }
}
